<!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º Fancybox –∏–∑ CDN -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.css" />
<script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.umd.js"></script>

<style>
    /* –°—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π */
    .root-folder-header {
      background-color: var(--lightBKG);
      padding: 15px 20px;
      text-align: center;
      margin-bottom: 20px;
      border-radius: 4px;
    }

    .root-folder-title {
      font-size: 18px;
      font-weight: 600;
      color: #333;
      margin: 0;
    }

    .media-gallery-captions {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 20px;
    }
    
    .media-title * {
        text-decoration: none;
    }

    .media-item {
      border-radius: 0px;
      overflow: hidden;
      background-color: var(--lightBKG);
      transition: transform 0.3s ease;
      cursor: pointer;
    }

    .media-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.08);
    }

    .media-image-container {
      height: 180px;
      overflow: hidden;
      position: relative;
    }

    .media-image {
      width: 100%;
      height: 100%;
      padding: 10px;
      object-fit: cover;
      display: block;
      transition: transform 0.3s ease;
    }

    .media-item:hover .media-image {
      transform: scale(1.03);
    }

    .media-caption {
      padding: 15px;
      background-color: var(--lightBKG);
      text-align: center;
      text-decoration: none;
    }

    .media-title {
      font-weight: 600;
      font-size: 14px;
      color: var(--dark-color);
      margin-bottom: 5px;
      word-break: break-word;
      text-decoration: none;
    }

    .media-description {
      font-size: 12px;
      color: var(--dark-color);
      line-height: 1.4;
      margin-bottom: 8px;
      text-decoration: none;
    }

    .media-meta {
      font-size: 11px;
      color: #888;
      display: flex;
      justify-content: space-between;
      border-top: 1px dashed #eee;
      padding-top: 8px;
      margin-top: 8px;
      text-decoration: none;
    }

    /* –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è Fancybox */
    .fancybox__container {
      --fancybox-bg: rgba(0, 0, 0, 0.9);
      --fancybox-thumbs-width: 80px;
      --fancybox-thumbs-ratio: 1;
    }

    .fancybox__toolbar {
      padding: 10px;
    }

    .fancybox__nav {
      --f-button-width: 50px;
      --f-button-height: 50px;
      --f-button-border-radius: 50%;
      --f-button-color: rgba(255, 255, 255, 0.9);
      --f-button-hover-color: white;
      --f-button-bg: rgba(30, 30, 30, 0.6);
      --f-button-hover-bg: rgba(0, 0, 0, 0.8);
      --f-button-active-bg: rgba(0, 0, 0, 0.9);
    }

    .fancybox__slide {
      padding: 20px;
    }

    .fancybox__caption {
      text-align: center;
      padding: 15px;
      background: rgba(0, 0, 0, 0.7);
      border-radius: 8px;
      max-width: 80%;
      margin: 0 auto 20px;
      text-decoration: none;
    }

    @media (max-width: 768px) {
      .root-folder-header {
        padding: 12px 15px;
        margin-bottom: 15px;
      }
      
      .root-folder-title {
        font-size: 16px;
      }
      
      .media-gallery-captions {
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
        gap: 15px;
        padding: 15px;
      }
      
      .media-image-container {
        height: 150px;
      }
    }

    .fancybox__infobar {
        font-size: 14px;
        color: rgba(255, 255, 255, 0.9);
        padding: 8px 12px;
        background: rgba(0, 0, 0, 0.5);
        border-radius: 20px;
    }

    .fancybox__infobar__count {
        font-weight: 500;
    }

    .media-item {
        text-decoration: none;
        color: inherit;
        display: block;
        
    }

    @media (max-width: 768px) {
        .fancybox__container {
            --fancybox-thumbs-width: 60px;
        }
    }

    .loading {
        text-align: center;
        padding: 40px;
        color: #666;
        font-size: 16px;
    }

    .no-media {
        text-align: center;
        padding: 40px;
        color: #666;
    }
</style>

<!-- –ù–û–í–ê–Ø –ü–ê–ù–ï–õ–¨ –° –ù–ê–ó–í–ê–ù–ò–ï–ú ROOT –§–û–õ–î–ï–†–ê -->
<div class="root-folder-header">
  <h1 class="root-folder-title">---</h1>
</div>

<!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –≥–∞–ª–µ—Ä–µ–∏ -->
<div id="gallery-container">
    <div class="loading">Loading gallery...</div>
</div>

<script>
    (function() {
        'use strict';
        
        // –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –ì–ò–¢–•–ê–ë
       const GITHUB_REPO = 'LordOfTheDepth/Peterhoff';
        const GITHUB_BRANCH = '6ecbc6a4ca5f904661d074f540adb15591422ef5';
        const GITHUB_FOLDER = '%D1%80%D0%B0%D0%B7%D1%80%D1%83%D1%88%D0%B5%D0%BD%D0%B8%D1%8F'; // –ü–∞–ø–∫–∞ "—Ä–∞–∑—Ä—É—à–µ–Ω–∏—è"

        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≥–∞–ª–µ—Ä–µ–∏
        const HEADER_NAME = "–ü–µ—Ç–µ—Ä–≥–æ—Ñ. –†–∞–∑—Ä—É—à–µ–Ω–∏—è"; // –û–±–Ω–æ–≤–∏—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∑–¥–µ—Å—å
        const GALLERY_ID = "gallery-" + new Date().getTime();
        
        // –û—Å–Ω–æ–≤–Ω–∞—è –∏ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö —Å GitHub
        async function loadFromGitHub() {
            try {
                console.log('üîÑ –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤ —Å GitHub...');
                
                // –§–æ—Ä–º–∏—Ä—É–µ–º URL –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ –∫ GitHub API
                // Docs: https://docs.github.com/en/rest/repos/contents#get-repository-content
                const apiUrl = `https://api.github.com/repos/${GITHUB_REPO}/contents/${GITHUB_FOLDER}?ref=${GITHUB_BRANCH}`;
                
                const response = await fetch(apiUrl);
                
                if (!response.ok) {
                    throw new Error(`GitHub API –æ—Ç–≤–µ—Ç–∏–ª —Å –∫–æ–¥–æ–º: ${response.status}`);
                }
                
                const data = await response.json();
                console.log(`‚úÖ –ü–æ–ª—É—á–µ–Ω–æ ${data.length} —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–∑ –ø–∞–ø–∫–∏.`);
                
                // –§–∏–ª—å—Ç—Ä—É–µ–º —Ç–æ–ª—å–∫–æ —Ñ–∞–π–ª—ã-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ –Ω—É–∂–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
                const imageFiles = data.filter(item => {
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —ç—Ç–æ —Ñ–∞–π–ª, –∞ –Ω–µ –ø–∞–ø–∫–∞
                    if (item.type !== 'file') return false;
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ (—Ç–æ–ª—å–∫–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)
                    const fileName = item.name.toLowerCase();
                    return fileName.endsWith('.jpg') || 
                           fileName.endsWith('.jpeg') || 
                           fileName.endsWith('.png') || 
                           fileName.endsWith('.gif');
                });
                
                console.log(`üñºÔ∏è –ù–∞–π–¥–µ–Ω–æ ${imageFiles.length} –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.`);
                
                // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ GitHub –≤ —Ñ–æ—Ä–º–∞—Ç, –ø–æ–Ω—è—Ç–Ω—ã–π –Ω–∞—à–µ–π –≥–∞–ª–µ—Ä–µ–µ
                return imageFiles.map(item => {
                    // –£–±–∏—Ä–∞–µ–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞–∑–≤–∞–Ω–∏—è
                    const displayTitle = item.name.replace(/\.[^.]+$/, "");
                    
                    return {
                        title: item.name,
                        displayTitle: displayTitle,
                        // –ò—Å–ø–æ–ª—å–∑—É–µ–º direct_url –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è (raw-–∫–æ–Ω—Ç–µ–Ω—Ç GitHub)
                        directUrl: item.download_url,
                        // –î–ª—è –ø—Ä–µ–≤—å—é –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ—Ç –∂–µ URL (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∑–∂–µ)
                        thumbnailUrl: item.download_url,
                        description: "", // –ü–æ–∫–∞ –æ—Å—Ç–∞–≤–ª—è–µ–º –ø—É—Å—Ç—ã–º, –∫–∞–∫ –≤—ã –ø—Ä–æ—Å–∏–ª–∏
                        size: item.size,
                        // GitHub API –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç UUID, –∏—Å–ø–æ–ª—å–∑—É–µ–º sha –∫–∞–∫ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
                        uuid: item.sha
                    };
                });
                
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö —Å GitHub:', error);
                // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏
                return [];
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è URL –ø—Ä–µ–≤—å—é (–æ—Å—Ç–∞–≤–ª–µ–Ω–∞ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å–æ —Å—Ç–∏–ª—è–º–∏)
        function getThumbnailURL(fileEntry) {
            return fileEntry.thumbnailUrl;
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è HTML –≥–∞–ª–µ—Ä–µ–∏ (–ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô)
        function createGallery(entries) {
            const container = document.getElementById('gallery-container');
            
            if (!entries || entries.length === 0) {
                container.innerHTML = `
                    <div class="no-media">
                      <p>–í —É–∫–∞–∑–∞–Ω–Ω–æ–π –ø–∞–ø–∫–µ –Ω–∞ GitHub –Ω–µ –Ω–∞–π–¥–µ–Ω–æ —Ñ–∞–π–ª–æ–≤-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.</p>
                      <p>–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –ø–∞–ø–∫–µ –µ—Å—Ç—å —Ñ–∞–π–ª—ã —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º–∏: .jpg, .jpeg, .png, .gif</p>
                    </div>
                `;
                return;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
            const folderTitle = document.querySelector('.root-folder-title');
            if (folderTitle && folderTitle.textContent === '---') {
                folderTitle.textContent = HEADER_NAME;
            }
            
            // –°–æ–∑–¥–∞–µ–º –≥–∞–ª–µ—Ä–µ—é
            const galleryHtml = `
                <div class="media-gallery-captions" id="${GALLERY_ID}">
                    ${entries.map((entry, index) => {
                        const imageURL = entry.directUrl;
                        const thumbURL = getThumbnailURL(entry);
                        const displayTitle = entry.displayTitle;
                        const description = entry.description || '';
                        const isImage = true; // –í—Å–µ —Ñ–∞–π–ª—ã —É–∂–µ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω—ã –∫–∞–∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                        
                        return `
                            <a href="${imageURL}" 
                               class="media-item"
                               data-fancybox="${GALLERY_ID}"
                               data-caption="<div style='text-align:center;'>
                                               <h4 style='margin:0 0 8px 0; color:white;'>${escapeHtml(displayTitle)}</h4>
                                               ${description ? `<p style='margin:0; color:#ccc; font-size:14px;'>${escapeHtml(description)}</p>` : ''}
                                             </div>"
                               data-thumb="${thumbURL}">
                              
                              <div class="media-image-container">
                                <img src="${thumbURL}" 
                                     alt="${escapeHtml(displayTitle)}" 
                                     class="media-image"
                                     loading="lazy"
                                     onerror="this.onerror=null; this.src='data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"200\" height=\"150\" viewBox=\"0 0 200 150\"><rect width=\"200\" height=\"150\" fill=\"%23f0f0f0\"/><text x=\"100\" y=\"75\" text-anchor=\"middle\" dy=\".3em\" font-family=\"Arial\" font-size=\"14\" fill=\"%23999\">–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</text></svg>'">
                              </div>
                              
                              <div class="media-caption">
                                <div class="media-title">${escapeHtml(displayTitle)}</div>
                                ${description ? `<div class="media-description">${escapeHtml(description)}</div>` : ''}
                              </div>
                            </a>
                        `;
                    }).join('')}
                </div>
            `;
            
            container.innerHTML = galleryHtml;
            initFancyboxGallery();
        }
        
        // –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ HTML (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
        function escapeHtml(text) {
            if (!text) return '';
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Fancybox (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Fancybox (–ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –í–ï–†–°–ò–Ø)
function initFancyboxGallery() {
    if (typeof Fancybox === 'undefined') {
        console.warn('Fancybox –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω, –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞...');
        setTimeout(initFancyboxGallery, 100);
        return;
    }
    
    // –ò—â–µ–º –í–°–ï —ç–ª–µ–º–µ–Ω—Ç—ã —Å –∞—Ç—Ä–∏–±—É—Ç–æ–º data-fancybox
    // –ù–µ —Ñ–∏–ª—å—Ç—Ä—É–µ–º –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É GALLERY_ID, –∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ–±—â–∏–π —Å–µ–ª–µ–∫—Ç–æ—Ä
    const galleryItems = document.querySelectorAll('[data-fancybox]');
    
    if (galleryItems.length > 0) {
        console.log(`‚úÖ –ù–∞–π–¥–µ–Ω–æ ${galleryItems.length} —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–ª—è Fancybox`);
        
        // –í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–±—â—É—é –≥–∞–ª–µ—Ä–µ—é –¥–ª—è –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
        Fancybox.bind(galleryItems, {
            Thumbs: { 
                autoStart: false,
                type: 'classic'
            },
            Toolbar: {
                display: {
                    left: ['infobar'],
                    middle: [],
                    right: ['iterateZoom', 'download', 'thumbs', 'close'],
                },
            },
            Images: {
                zoom: true,
                wheel: 'slide'
            },
            Carousel: {
                infinite: true,
                Navigation: false
            },
            on: {
                init: (fancybox) => {
                    console.log('üéØ Fancybox —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                }
            }
        });
        
    } else {
        console.warn('‚ö†Ô∏è –ù–µ –Ω–∞–π–¥–µ–Ω–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–ª—è Fancybox');
    }
}
        
        // –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
        async function initGallery() {
            console.log('üöÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥–∞–ª–µ—Ä–µ–∏ —Å GitHub...');
            
            try {
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¢–û–õ–¨–ö–û —á–µ—Ä–µ–∑ GitHub
                const entries = await loadFromGitHub();
                
                console.log(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${entries.length} –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è –≥–∞–ª–µ—Ä–µ–∏.`);
                
                // –°–æ–∑–¥–∞–µ–º –≥–∞–ª–µ—Ä–µ—é
                createGallery(entries);
                
            } catch (error) {
                console.error('‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≥–∞–ª–µ—Ä–µ—é:', error);
                
                // –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –æ—à–∏–±–∫–µ
                document.getElementById('gallery-container').innerHTML = `
                    <div class="no-media">
                      <p>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≥–∞–ª–µ—Ä–µ–∏.</p>
                      <p>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é GitHub –≤ –∫–æ–¥–µ —Å–∫—Ä–∏–ø—Ç–∞.</p>
                      <p>–û—à–∏–±–∫–∞: ${error.message}</p>
                      <p style="margin-top: 20px;">
                        <button onclick="location.reload()">–û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É</button>
                      </p>
                    </div>
                `;
            }
        }
        
        // –ó–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initGallery);
        } else {
            initGallery();
        }
        
    })();
</script>